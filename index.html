<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AgroBet - Apostas Esportivas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Montserrat:wght@400;700&display=swap');
        body { font-family: 'Montserrat', sans-serif; background-color: #f8f8f8; }
        .title-font { font-family: 'Bebas Neue', cursive; }
        .bet-option.selected { background-color: #1b5e20; color: white; border-color: #1b5e20; }
        .confirm-btn { background: linear-gradient(135deg, #2e7d32 0%, #1b5e20 100%); }
    </style>
</head>
<body class="bg-gray-100">

    <!-- Header (inalterado) -->
    <header class="bg-green-800 text-white py-4 shadow-md sticky top-0 z-40">
        <!-- ... -->
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <section id="open-games-section">
            <h2 class="title-font text-3xl md:text-4xl text-green-800 mb-8 text-center">JOGOS DISPONÍVEIS</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8" id="games-container">
                <!-- Jogos com odds carregados aqui -->
            </div>
        </section>
        <section id="results-section" class="mt-16">
            <!-- ... -->
        </section>
    </main>

    <!-- Modals (inalterados) -->
    <!-- ... -->

    <script>
        const SERVER_URL = 'https://agrobets.onrender.com';
        // ... (outras variáveis globais)

        async function loadOpenGames() {
            try {
                const response = await fetch(`${SERVER_URL}/games`);
                const games = await response.json();
                allGames = games;
                gamesContainer.innerHTML = '';
                if (games.length === 0) { /* ... */ return; }
                games.forEach(game => {
                    const gameId = game._id;
                    gamesContainer.innerHTML += `
                    <div class="bet-card bg-white rounded-lg shadow-md border" data-game-id="${gameId}">
                        <div class="p-6">
                            <!-- ... (cabeçalho do jogo com logos) ... -->
                            <div class="mb-4">
                                <h4 class="font-bold mb-2 text-center">PALPITE:</h4>
                                <div class="grid grid-cols-3 gap-2 bet-options">
                                    <button class="bet-option py-2 border rounded" data-option="home">
                                        <span>${game.home.name}</span>
                                        <span class="font-bold text-green-600">${game.odds.home}</span>
                                    </button>
                                    <button class="bet-option py-2 border rounded" data-option="empate">
                                        <span>EMPATE</span>
                                        <span class="font-bold text-green-600">${game.odds.draw}</span>
                                    </button>
                                    <button class="bet-option py-2 border rounded" data-option="away">
                                        <span>${game.away.name}</span>
                                        <span class="font-bold text-green-600">${game.odds.away}</span>
                                    </button>
                                </div>
                            </div>
                            <div class="mb-4">
                                <h4 class="font-bold mb-2 text-center">VALOR DA APOSTA (R$):</h4>
                                <input type="number" class="bet-value-input w-full p-2 border rounded text-center" placeholder="Ex: 10.00">
                            </div>
                            <div class="text-center font-bold mb-4">
                                Retorno Potencial: <span class="potential-payout text-green-700">R$ 0.00</span>
                            </div>
                            <button class="confirm-btn w-full py-3 rounded-md text-white font-bold" disabled>APOSTAR</button>
                        </div>
                    </div>`;
                });
                addGameEventListeners();
            } catch (error) { /* ... */ }
        }
        
        function addGameEventListeners() { 
            document.querySelectorAll('.bet-card').forEach(card => {
                let selectedOption = null;
                let selectedOdd = 0;

                // Evento para selecionar palpite
                card.querySelector('.bet-options').addEventListener('click', e => {
                    const button = e.target.closest('button');
                    if(button){
                        // ... (lógica para destacar o botão)
                        selectedOption = button.dataset.option;
                        const game = allGames.find(g => g._id === card.dataset.gameId);
                        selectedOdd = game.odds[selectedOption === 'empate' ? 'draw' : selectedOption];
                        updatePayout();
                    }
                });

                // Evento para atualizar o valor da aposta
                const valueInput = card.querySelector('.bet-value-input');
                valueInput.addEventListener('input', updatePayout);

                function updatePayout(){
                    const value = parseFloat(valueInput.value) || 0;
                    const payout = value * selectedOdd;
                    card.querySelector('.potential-payout').textContent = `R$ ${payout.toFixed(2)}`;
                    // ... (lógica para habilitar/desabilitar o botão)
                }

                card.querySelector('.confirm-btn').addEventListener('click', () => {
                    const value = parseFloat(valueInput.value);
                    handleBet(card.dataset.gameId, selectedOption, value);
                });
            });
        }
        
        async function handleBet(gameId, option, value) {
            // ... (a lógica de handleBet agora só precisa de passar option e value)
        }

        // ... (resto do script)
    </script>
</body>
</html>

